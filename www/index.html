<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <title>Code Route 1 </title>
    <style>
        body {
            height: 100%;
        }

        .main {
            display: flex;
            margin-top: 100px;
            height: 100%;
            min-height: 100%;
            justify-content: center;
            align-items: center;
        }
    </style>
    <script type="text/javascript" src="scripts/jquery.js"></script>

</head>

<body>
    <div class="main" dir="rtl">
        <form id="f" method="GET">
            <div>
                <label for="username">رقم الهاتف</label>
                <input type="text" id="username" size="8" autofocus autocomplete="on">
            </div>
            <div>
                <label for="password">كلمة السر</label>
                <input type="password" id="password" size="8" autocomplete="on">
            </div>
            <input type="checkbox" id="rm" value="" checked> remember me <br>
            <input type="button" id="button" value="OK" onclick="l()">


        </form>
    </div>


    <script>
        nb = 0;


        if (typeof (Storage) !== "undefined") {

            if (localStorage.pNumber != '') {
                $('#username').val(localStorage.pNumber);
                $('#password').val(localStorage.pwd);
            }
            // Code for localStorage/sessionStorage.
        } else {
            // Sorry! No Web Storage support..
            $("#rm").hide();
        }

        function l() {
            if (nb < 3) {
                $.ajax
                    ({
                        type: "GET",
                        url: "http://51.178.25.226:8008/access",
                        headers: {
                            "Authorization": "Basic " + btoa($("#username").val() + ":" + $("#password").val())
                        }
                    })
                    .done(function () {
                        //alert('Authenticated!');
                        if (typeof (Storage) !== "undefined") {
                            if ($('#rm').is(':checked')) {
                                // save username and password
                                localStorage.pNumber = $('#username').val();
                                localStorage.pwd = $('#password').val();
                                //localStorage.checkBoxValidation = $('#rememberMe').val();
                            } else {
                                localStorage.removeItem("pNumber");
                                localStorage.removeItem("pwd");
                                //localStorage.checkBoxValidation = '';
                            }
                        }
                        window.location = "menu.html";
                    })
                    .fail(function () {

                        $("#password").val("");
                        $("#username").val("");
                        $("#username").focus();
                        if (typeof (Storage) !== "undefined") {
                            localStorage.removeItem("pNumber");
                            localStorage.removeItem("pwd");
                        }

                        nb++;
                    });
            } else {
                $("#button").attr("disabled", true);
                $("#username").attr("disabled", true);
                $("#password").attr("disabled", true);
            }

        }

    </script>

</body>

</html>